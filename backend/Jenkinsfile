pipeline {
	agent any

  tools {
		maven 'maven'
    jdk   'jdk17'
  }

  options { skipDefaultCheckout(true) }

  stages {
		stage('Checkout') {
			steps {
				checkout scm
      }
    }

    stage('Build') {
			steps {
				dir('backend') {
					bat 'mvn -B clean compile'
        }
      }
    }

    stage('Test') {
			steps {
				dir('backend') {
					bat 'mvn -B test'
        }
      }
      post {
				always {
          junit 'backend/target/surefire-reports/*.xml'
        }
      }
    }

    stage('Package') {
			steps {
				dir('backend') {
					bat 'mvn -B package'
        }
      }
    }
  }

  post {
		success {
      archiveArtifacts artifacts: 'backend/target/*.jar', fingerprint: true
    }
  }
}
